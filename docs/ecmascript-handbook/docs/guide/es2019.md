# ES2019 (ES10)

ECMAScript 2019 (ES10) 带来了一系列实用的新特性，主要集中在数组、对象和字符串处理上，并对一些现有语法进行了优化。

## 1. `Array.prototype.flat()` 和 `Array.prototype.flatMap()`

### `flat()`

`flat()` 方法会按照一个可指定的深度递归遍历数组，并将所有子数组中的元素合并为一个新数组返回。

**语法**：`arr.flat([depth])`
- `depth` (可选): 指定要提取嵌套数组的结构深度，默认为 1。

```javascript
const arr1 = [1, 2, [3, 4]];
console.log(arr1.flat()); // [1, 2, 3, 4]

const arr2 = [1, [2, [3, [4]]]];
console.log(arr2.flat());   // [1, 2, [3, [4]]] (默认深度为 1)
console.log(arr2.flat(2));  // [1, 2, 3, [4]]
console.log(arr2.flat(Infinity)); // [1, 2, 3, 4] (展开任意深度)
```

`flat()` 方法会自动移除数组中的空位。

```javascript
const arrWithEmpty = [1, 2, , 4, 5];
console.log(arrWithEmpty.flat()); // [1, 2, 4, 5]
```

### `flatMap()`

`flatMap()` 方法首先使用映射函数映射每个元素，然后将结果展平一级。它等同于 `map()` 后面紧跟一个深度为 1 的 `flat()`，但效率更高。

**语法**：`arr.flatMap(callback)`

```javascript
const arr = [1, 2, 3];

// 使用 map 和 flat
const mappedAndFlatted = arr.map(x => [x, x * 2]).flat();
// [[1, 2], [2, 4], [3, 6]] -> [1, 2, 2, 4, 3, 6]

// 使用 flatMap
const flatMapped = arr.flatMap(x => [x, x * 2]);
// [1, 2, 2, 4, 3, 6]

console.log(mappedAndFlatted);
console.log(flatMapped);
```

## 2. `Object.fromEntries()`

这个方法是 `Object.entries()` 的逆操作。`Object.entries()` 将一个对象转换为 `[key, value]` 键值对数组，而 `Object.fromEntries()` 则将一个键值对的可迭代对象（如 `Array`, `Map`）转换回一个新对象。

```javascript
const entries = [['foo', 'bar'], ['baz', 42]];
const obj = Object.fromEntries(entries);
console.log(obj); // { foo: "bar", baz: 42 }
```

一个常见的用例是将 `Map` 结构转换回普通对象。

```javascript
const map = new Map([ ['name', 'Yorke'], ['age', 30] ]);
const objFromMap = Object.fromEntries(map);
console.log(objFromMap); // { name: "Yorke", age: 30 }
```

## 3. `String.prototype.trimStart()` 和 `String.prototype.trimEnd()`

`trim()` 方法用于移除字符串两端的空白字符。ES2019 提供了 `trimStart()` 和 `trimEnd()`，允许我们只移除字符串头部或尾部的空白。

- `trimStart()`: 移除字符串开头的空白。
- `trimEnd()`: 移除字符串末尾的空白。

```javascript
const greeting = '   Hello world!   ';

console.log(greeting.trim());       // 'Hello world!'
console.log(greeting.trimStart());  // 'Hello world!   '
console.log(greeting.trimEnd());    // '   Hello world!'
```
为了向后兼容，`trimLeft()` 和 `trimRight()` 是这两个方法的别名。

## 4. 可选的 `catch` 绑定

在 ES2019 之前，`try...catch` 语句中的 `catch` 部分必须带有一个参数（通常是 `e` 或 `error`），即使你在 `catch` 块中根本用不到这个错误对象。

```javascript
// ES2019 之前
try {
  // ...
} catch (err) { // 必须有 (err)
  console.log('An error occurred, but I do not care what it is.');
}
```

ES2019 允许省略 `catch` 的参数及其括号。

```javascript
// ES2019
try {
  // ...
} catch { // 可以省略 (err)
  console.log('An error occurred!');
}
```

## 5. `Symbol.prototype.description`

`Symbol()` 函数可以接受一个字符串作为参数，用于对 `Symbol` 实例进行描述。ES2019 增加了一个只读属性 `description`，可以直接获取这个描述。

```javascript
const mySymbol = Symbol('This is my symbol');
console.log(mySymbol.description); // "This is my symbol"
```

## 6. 其他更新

- **`JSON.stringify()` 增强**：修复了对于超出范围的 Unicode 字符（如 `\uD800` 到 `\uDFFF`）会返回格式错误的 Unicode 字符串的问题，现在会用转义序列替换它们。
- **`Function.prototype.toString()` 增强**：现在会精确返回函数的源代码，包括注释和空格。